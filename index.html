<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>iframe tester</title>
    <link rel="stylesheet" href="https://public.codepenassets.com/css/reset-2.0.min.css">


  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiara4u Radio Player</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background 1s ease;
            overflow: hidden;
            position: relative;
        }

        .background-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: -1;
        }

        .player-container {
            width: 90%;
            max-width: 500px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .cover-container {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 0 auto 25px;
        }

        .cover-art {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease;
            background: linear-gradient(45deg, #ff4081, #ff79a6);
        }

        .spinning {
            animation: spin 20s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .neon-effect {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border-radius: 50%;
            box-shadow: 0 0 20px #fff, 0 0 40px #fff, 0 0 60px #fff;
            opacity: 0.5;
            animation: pulse 2s infinite alternate;
            pointer-events: none;
        }

        @keyframes pulse {
            0% { opacity: 0.3; box-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #fff; }
            100% { opacity: 0.7; box-shadow: 0 0 20px #fff, 0 0 40px #fff, 0 0 60px #fff; }
        }

        .track-info {
            margin-bottom: 25px;
        }

        .track-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            min-height: 28px;
        }

        .track-artist {
            font-size: 16px;
            color: #e0e0e0;
            margin-bottom: 5px;
            min-height: 20px;
        }

        .track-album {
            font-size: 14px;
            color: #b0b0b0;
            min-height: 18px;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .play-pause {
            width: 60px;
            height: 60px;
            font-size: 24px;
            background: linear-gradient(135deg, #ff4081, #ff79a6);
        }

        .volume-container {
            display: flex;
            align-items: center;
            margin-top: 15px;
            gap: 10px;
        }

        .volume-slider {
            flex: 1;
            height: 5px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            outline: none;
            -webkit-appearance: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #ff4081;
            cursor: pointer;
        }

        .status {
            margin-top: 15px;
            font-size: 14px;
            color: #b0b0b0;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @media (max-width: 768px) {
            .player-container {
                width: 95%;
                padding: 20px;
            }
            
            .cover-container {
                width: 200px;
                height: 200px;
            }
            
            .track-title {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="background-overlay"></div>
    
    <div class="player-container">
        <div class="cover-container">
            <img id="coverArt" class="cover-art" src="http://cdn.theradiohub.com/logos/157.jpg" alt="Cover Art">
            <div class="neon-effect"></div>
        </div>
        
        <div class="track-info">
            <div class="track-title" id="trackTitle">Memuat informasi lagu...</div>
            <div class="track-artist" id="trackArtist">Kiara 4U</div>
            <div class="track-album" id="trackAlbum">Online Radio</div>
        </div>
        
        <div class="controls">
            <button class="control-btn" id="prevBtn">‚èÆ</button>
            <button class="control-btn play-pause" id="playPauseBtn">‚ñ∂</button>
            <button class="control-btn" id="nextBtn">‚è≠</button>
        </div>
        
        <div class="volume-container">
            <span>üîä</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="80">
        </div>
        
        <div class="status" id="status">
            Siap untuk memutar
            <span class="loading" id="loadingIndicator" style="display: none;"></span>
        </div>
    </div>

    <script>
        // Elemen DOM
        const coverArt = document.getElementById('coverArt');
        const trackTitle = document.getElementById('trackTitle');
        const trackArtist = document.getElementById('trackArtist');
        const trackAlbum = document.getElementById('trackAlbum');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        const status = document.getElementById('status');
        const loadingIndicator = document.getElementById('loadingIndicator');
        
        // Konfigurasi
        const streamUrl = 'https://eu1.fastcast4u.com/proxy/kiarafm?mp=/1';
        const nowPlayingUrl = 'http://178.33.135.244:21464/currentsong?sid=1';
        const defaultCover = 'http://cdn.theradiohub.com/logos/157.jpg';
        
        // State
        let isPlaying = false;
        let nowPlayingInterval;
        
        // Buat elemen audio
        const audio = new Audio(streamUrl);
        audio.crossOrigin = 'anonymous';
        audio.volume = volumeSlider.value / 100;
        
        // Fungsi untuk mengambil data now playing dengan berbagai metode
        async function fetchNowPlaying() {
            // Coba beberapa metode untuk mendapatkan data lagu
            const methods = [
                // Metode 1: Direct fetch dengan error handling
                async () => {
                    try {
                        const response = await fetch(nowPlayingUrl);
                        if (response.ok) {
                            return await response.text();
                        }
                    } catch (error) {
                        console.log('Metode 1 gagal:', error);
                    }
                    return null;
                },
                // Metode 2: Menggunakan CORS proxy
                async () => {
                    try {
                        const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(nowPlayingUrl);
                        const response = await fetch(proxyUrl);
                        if (response.ok) {
                            return await response.text();
                        }
                    } catch (error) {
                        console.log('Metode 2 gagal:', error);
                    }
                    return null;
                },
                // Metode 3: Menggunakan CORS proxy alternatif
                async () => {
                    try {
                        const proxyUrl = 'https://corsproxy.io/?' + encodeURIComponent(nowPlayingUrl);
                        const response = await fetch(proxyUrl);
                        if (response.ok) {
                            return await response.text();
                        }
                    } catch (error) {
                        console.log('Metode 3 gagal:', error);
                    }
                    return null;
                }
            ];
            
            // Coba semua metode sampai berhasil
            for (const method of methods) {
                const result = await method();
                if (result) {
                    console.log('Data lagu berhasil didapat:', result);
                    return result;
                }
            }
            
            console.log('Semua metode gagal');
            return null;
        }
        
        // Fungsi untuk memproses data lagu
        function processTrackData(data) {
            if (!data || data.trim() === '') {
                return {
                    title: 'Kiara 4U',
                    artist: 'Live Streaming',
                    album: 'Online Radio'
                };
            }
            
            // Coba berbagai format data lagu
            let title = '';
            let artist = '';
            let album = 'Kiara 4U';
            
            // Format 1: Artist - Title
            if (data.includes(' - ')) {
                const parts = data.split(' - ');
                artist = parts[0].trim();
                title = parts[1].trim();
            }
            // Format 2: Title by Artist
            else if (data.toLowerCase().includes(' by ')) {
                const parts = data.split(/ by /i);
                title = parts[0].trim();
                artist = parts[1].trim();
            }
            // Format 3: Hanya judul
            else {
                title = data.trim();
                artist = 'Unknown Artist';
            }
            
            // Jika data kosong, gunakan default
            if (!title) {
                title = 'Kiara 4U';
                artist = 'Live Streaming';
            }
            
            return { title, artist, album };
        }
        
        // Update now playing info
        async function updateNowPlaying() {
            loadingIndicator.style.display = 'inline-block';
            
            try {
                const data = await fetchNowPlaying();
                const trackInfo = processTrackData(data);
                
                // Update UI
                trackTitle.textContent = trackInfo.title;
                trackArtist.textContent = trackInfo.artist;
                trackAlbum.textContent = trackInfo.album;
                
                // Update cover art - coba cari berdasarkan judul dan artis
                await updateCoverArt(trackInfo.title, trackInfo.artist);
                
            } catch (error) {
                console.error('Error dalam updateNowPlaying:', error);
                // Gunakan nilai default jika terjadi error
                trackTitle.textContent = 'Kiara 4U';
                trackArtist.textContent = 'Live Streaming';
                trackAlbum.textContent = 'Online Radio';
                coverArt.src = defaultCover;
                updateBackgroundColor();
            } finally {
                loadingIndicator.style.display = 'none';
            }
        }
        
        // Fungsi untuk mencari cover art
        async function updateCoverArt(title, artist) {
            // Coba berbagai sumber untuk cover art
            const coverSources = [
                // Sumber 1: Last.fm API (menggunakan proxy)
                async () => {
                    try {
                        const searchUrl = `https://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=YOUR_API_KEY&artist=${encodeURIComponent(artist)}&track=${encodeURIComponent(title)}&format=json`;
                        const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(searchUrl);
                        const response = await fetch(proxyUrl);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.track && data.track.album && data.track.album.image && data.track.album.image.length > 0) {
                                return data.track.album.image[data.track.album.image.length - 1]['#text'];
                            }
                        }
                    } catch (error) {
                        console.log('Last.fm API gagal:', error);
                    }
                    return null;
                },
                // Sumber 2: iTunes API
                async () => {
                    try {
                        const searchUrl = `https://itunes.apple.com/search?term=${encodeURIComponent(artist + ' ' + title)}&entity=song&limit=1`;
                        const response = await fetch(searchUrl);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.results && data.results.length > 0) {
                                return data.results[0].artworkUrl100.replace('100x100', '500x500');
                            }
                        }
                    } catch (error) {
                        console.log('iTunes API gagal:', error);
                    }
                    return null;
                },
                // Sumber 3: Deezer API
                async () => {
                    try {
                        const searchUrl = `https://api.deezer.com/search?q=${encodeURIComponent(artist + ' ' + title)}&limit=1`;
                        const response = await fetch(searchUrl);
                        if (response.ok) {
                            const data = await response.json();
                            if (data.data && data.data.length > 0) {
                                return data.data[0].album.cover_xl || data.data[0].album.cover_big;
                            }
                        }
                    } catch (error) {
                        console.log('Deezer API gagal:', error);
                    }
                    return null;
                }
            ];
            
            // Coba semua sumber cover art
            for (const source of coverSources) {
                const coverUrl = await source();
                if (coverUrl) {
                    console.log('Cover art ditemukan:', coverUrl);
                    setCoverArt(coverUrl);
                    return;
                }
            }
            
            // Jika semua sumber gagal, gunakan default
            console.log('Menggunakan default cover art');
            coverArt.src = defaultCover;
            updateBackgroundColor();
        }
        
        // Fungsi untuk mengatur cover art dengan fallback
        function setCoverArt(url) {
            coverArt.src = url;
            
            coverArt.onerror = function() {
                console.log('Cover art gagal dimuat, mencoba proxy...');
                // Coba dengan proxy
                const proxyUrl = 'https://images.weserv.nl/?url=' + encodeURIComponent(url.replace(/^https?:\/\//, ''));
                coverArt.src = proxyUrl;
                
                coverArt.onerror = function() {
                    console.log('Proxy juga gagal, menggunakan default');
                    coverArt.src = defaultCover;
                    coverArt.onerror = null;
                };
            };
            
            coverArt.onload = function() {
                console.log('Cover art berhasil dimuat');
                updateBackgroundColor();
            };
        }
        
        // Update background color
        function updateBackgroundColor() {
            const colors = [
                'linear-gradient(135deg, #1a1a2e, #16213e)',
                'linear-gradient(135deg, #0f3460, #1a1a2e)',
                'linear-gradient(135deg, #533483, #1a1a2e)',
                'linear-gradient(135deg, #40514e, #1a1a2e)',
                'linear-gradient(135deg, #ff7c7c, #1a1a2e)',
                'linear-gradient(135deg, #47b8e0, #1a1a2e)',
                'linear-gradient(135deg, #ffb347, #1a1a2e)',
                'linear-gradient(135deg, #a8e6cf, #1a1a2e)'
            ];
            
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            document.body.style.background = randomColor;
        }
        
        // Toggle putaran cover art
        function toggleCoverRotation() {
            coverArt.classList.toggle('spinning', isPlaying);
        }
        
        // Toggle play/pause
        function togglePlayPause() {
            if (isPlaying) {
                audio.pause();
                playPauseBtn.textContent = '‚ñ∂';
                status.textContent = 'Dijeda';
            } else {
                audio.play().then(() => {
                    playPauseBtn.textContent = '‚è∏';
                    status.textContent = 'Sedang Memutar';
                }).catch(error => {
                    console.error('Error playing audio:', error);
                    status.textContent = 'Error: Tidak dapat memutar audio';
                });
            }
            
            isPlaying = !isPlaying;
            toggleCoverRotation();
        }
        
        // Event Listeners
        playPauseBtn.addEventListener('click', togglePlayPause);
        
        volumeSlider.addEventListener('input', () => {
            audio.volume = volumeSlider.value / 100;
        });
        
        // Event saat audio dimulai
        audio.addEventListener('play', () => {
            isPlaying = true;
            playPauseBtn.textContent = '‚è∏';
            status.textContent = 'Sedang Memutar';
            toggleCoverRotation();
        });
        
        // Event saat audio dijeda
        audio.addEventListener('pause', () => {
            isPlaying = false;
            playPauseBtn.textContent = '‚ñ∂';
            status.textContent = 'Dijeda';
            toggleCoverRotation();
        });
        
        // Event saat terjadi error pada audio
        audio.addEventListener('error', (e) => {
            console.error('Audio error:', e);
            status.textContent = 'Error: Tidak dapat memuat stream';
        });
        
        // Event saat audio sedang loading
        audio.addEventListener('waiting', () => {
            status.textContent = 'Buffering...';
        });
        
        // Event saat audio dapat diputar
        audio.addEventListener('canplay', () => {
            status.textContent = 'Siap untuk memutar';
        });
        
        // Inisialisasi
        function init() {
            updateNowPlaying();
            
            // Update now playing setiap 15 detik
            nowPlayingInterval = setInterval(updateNowPlaying, 15000);
        }
        
        // Jalankan inisialisasi saat halaman dimuat
        window.addEventListener('load', init);
    </script>
</body>
</html>
    
  </body>
  
</html>
